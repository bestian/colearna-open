import{i as x}from"./index.619f7a66.js";import{u as Ke}from"./use-meta.d8f6c85f.js";import{N as We,Q as Je,t as $,p as Ye}from"./NavigationBar.4f882ef7.js";import{u as qe,s as n,r as a}from"./index.de236903.js";import{Q as _}from"./QBtn.28a78695.js";import{Q as F}from"./QIcon.55f2315c.js";import{Q as Me}from"./QFile.9d75261f.js";import{Q as A}from"./QForm.4af9a803.js";import{Q as P}from"./QCard.9070155d.js";import{Q as b}from"./QItem.ded192b4.js";import{Q as R}from"./QSeparator.185553d2.js";import{Q as N}from"./QList.f527e085.js";import{Q as k}from"./QInput.ca83d44b.js";import{Q as Xe}from"./QPage.25196c1e.js";import{v as g,D as B,A as c,x as C,y as f,f as l,C as p,L as et,U as tt,F as L,S as I,B as Q,z as S,H as E,E as st,G as it,_ as nt,d as at,r as s}from"./index.1b2c6786.js";import"./index.esm.5c1ec681.js";import"./QSpinner.a70f049c.js";import"./render.052cf9de.js";import"./Ripple.72425708.js";import"./use-router-link.a6f89557.js";import"./vm.78afe1d7.js";import"./QChip.e81030b4.js";import"./use-dark.e08b0fca.js";import"./use-key-composition.5ab50ccb.js";import"./format.3e32b8d9.js";const D=e=>(st("data-v-07366312"),e=e(),it(),e),ot={key:0,class:"row long-padded"},ut=D(()=>f("h2",{class:"text-dark-green"},"\u60A8\u6C92\u6709\u8001\u5E2B\u6B0A\u9650\uFF0C\u8ACB\u5148\u767B\u5165",-1)),rt=[ut],lt={key:1,class:"row"},ct={class:"col col-md-3 col-sm-4 col-xs-12 padded"},dt=["src"],ht={class:"text-orange margin-left"},mt={class:"col col-md-9 col-sm-8 col-xs-12 padded"},ft=D(()=>f("h4",{class:"text-left text-dark-green fluid"},"\u6559\u5E2B\u6A94\u6848",-1)),gt=D(()=>f("p",{class:"text-gray bold"},"\u586B\u5165\u4EE5\u4E0B\u8CC7\u6599\uFF0C\u7CFB\u7D71\u5C07\u6703\u81EA\u52D5\u8001\u5E2B\u500B\u4EBA\u9801\u9762",-1)),wt={class:"row"},pt={class:"col-12"},Dt=D(()=>f("h4",{class:"text-left text-dark-green fluid"},"\u6211\u7684\u7C21\u4ECB",-1)),_t=D(()=>f("h4",{class:"text-left text-dark-green fluid"},"\u6559\u5B78\u7406\u5FF5",-1)),Ct=D(()=>f("h4",{class:"text-left text-dark-green fluid"},"\u5C08\u696D\u8B49\u7167",-1)),At={class:"flex margin"},Bt=D(()=>f("div",{class:"filler"},null,-1)),yt={key:1,class:"teacher-profile-card-3"},Ft=D(()=>f("h4",{class:"text-dark-green"},"\u6536\u5165\u6982\u89BD",-1)),bt=D(()=>f("div",{class:"row no-margin fluid flex flex-start-center llgg-back"},[f("div",{class:"col-md-6 col-sm-6 col-xs-12 flex flex-col flex-center"},[f("h6",{class:"text-dark-green"},"2023\u5E7405\u6708\u6536\u5165\u7E3D\u984D\uFF1A")]),f("div",{class:"col-md-6 col-sm-6 col-xs-12 flex flex-col flex-center"},[f("h4",{class:"text-dark-green"},"21,000TWD")])],-1)),kt=[Ft,bt];function Et(e,t,i,r,d,h){return g(),B(Xe,null,{default:c(()=>[!e.uid||!e.me||!e.isTeacher?(g(),C("div",ot,rt)):(g(),C("div",lt,[f("div",ct,[l(P,{class:"teacher-profile-card fluid flex flex-col flex-start-center"},{default:c(()=>[f("img",{class:"big avatar",src:e.myPhotoURL},null,8,dt),l(_,{class:"no-border no-bg text-dark-green text-underline",unelevated:"",onClick:t[0]||(t[0]=u=>e.editP=!0)},{default:c(()=>[p("\u7DE8\u8F2F")]),_:1}),f("h6",ht,[l(F,{name:"check_circle_outline"}),p("\u5DF2\u8A8D\u8B49")]),et(l(A,{class:"flex flex-center fluid"},{default:c(()=>[l(Me,{class:"fluid",color:"teal",filled:"",label:"\u4E0A\u50B3\u5927\u982D\u8CBC",accept:"image/*",onInput:t[1]||(t[1]=u=>e.uploadImage(u)),name:"photoURL"},{prepend:c(()=>[l(F,{name:"cloud_upload"})]),_:1})]),_:1},512),[[tt,e.editP]])]),_:1}),l(P,{class:"teacher-profile-card"},{default:c(()=>[l(N,null,{default:c(()=>[(g(!0),C(L,null,I(e.inner_options,(u,m)=>(g(),B(b,{class:S(["text-gray flex flex-start-center",{"text-bold":e.action==u.t,"text-dark-green":e.action==u.t,"llgg-back":e.action==u.t}]),clickable:"",key:m,onClick:w=>e.sel(u)},{default:c(()=>[p(E(u.t),1)]),_:2},1032,["onClick","class"]))),128)),l(R,{style:{"margin-bottom":"1em"}}),(g(!0),C(L,null,I(e.options,(u,m)=>(g(),B(b,{class:S(["text-gray flex flex-start-center",{"text-dark-green":e.action==u.t,"light-green-back":e.action==u.t}]),key:m,to:u.path},{default:c(()=>[p(E(u.t),1)]),_:2},1032,["to","class"]))),128)),l(R,{style:{"margin-bottom":"1em"}}),l(b,{class:"text-gray flex flex-start-center",onClick:e.logout},{default:c(()=>[p("\u767B\u51FA")]),_:1},8,["onClick"])]),_:1})]),_:1})]),f("div",mt,[e.action=="\u6559\u5E2B\u6A94\u6848"?(g(),B(P,{key:0,class:"profile-card-2"},{default:c(()=>[ft,gt,f("div",wt,[f("div",pt,[l(A,{class:"flex flex-start-center fluid row"},{default:c(()=>[l(k,{class:"margin",rounded:"",outlined:"",modelValue:e.myName,"onUpdate:modelValue":t[2]||(t[2]=u=>e.myName=u),placeholder:"\u4F60\u559C\u6B61\u5B78\u751F\u600E\u9EBC\u7A31\u547C\u4F60?",style:{width:"100%"},onFocus:t[3]||(t[3]=u=>{e.focusDate=[],e.focusMyDate=!1})},null,8,["modelValue"])]),_:1}),Dt,l(A,{class:"flex flex-start-center fluid row"},{default:c(()=>[l(k,{class:"margin",rounded:"",outlined:"",type:"textarea",modelValue:e.newDes,"onUpdate:modelValue":t[4]||(t[4]=u=>e.newDes=u),placeholder:"\u95DC\u65BC\u6211\u7684\u7C21\u4ECB",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),_t,l(A,{class:"flex flex-start-center fluid row"},{default:c(()=>[l(k,{class:"margin",rounded:"",outlined:"",type:"textarea",modelValue:e.newThought,"onUpdate:modelValue":t[5]||(t[5]=u=>e.newThought=u),placeholder:"\u6559\u5B78\u7406\u5FF5",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),Ct,l(k,{rounded:"",outlined:"",modelValue:e.newCer,"onUpdate:modelValue":t[7]||(t[7]=u=>e.newCer=u),placeholder:"\u5C08\u696D\u8B49\u7167(\u9078\u586B)",style:{width:"66%","min-width":"320px"}},{prepend:c(()=>[l(F,{name:"add",color:"green"})]),append:c(()=>[l(_,{color:"secondary",onClick:t[6]||(t[6]=u=>e.addCer())},{default:c(()=>[p("\u65B0\u589E")]),_:1})]),_:1},8,["modelValue"]),l(N,{bulleted:"",style:{width:"66%","min-width":"320px"}},{default:c(()=>[(g(!0),C(L,null,I(e.newCertifications||[],(u,m)=>(g(),B(b,{key:m},{default:c(()=>[f("div",At,E(m+1)+"\uFF1A "+E(u),1),Bt,l(_,{size:"xs margin",color:"red",onClick:w=>e.removeCer(m)},{default:c(()=>[l(F,{name:"delete"})]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})])]),l(A,null,{default:c(()=>[l(_,{class:"margin",unelevated:"",rounded:"",color:"green-6",onClick:t[8]||(t[8]=u=>e.submit()),size:"lg",icon:"save"},{default:c(()=>[p("\u5132\u5B58")]),_:1}),l(_,{class:"margin",unelevated:"",rounded:"",color:"blue-3",onClick:t[9]||(t[9]=u=>e.previewProfile()),size:"lg",icon:"visibility"},{default:c(()=>[p("\u9810\u89BD")]),_:1}),l(_,{class:"margin",unelevated:"",rounded:"",color:"orange-12",onClick:t[10]||(t[10]=u=>e.gotoT(e.uid)),size:"lg","icon-right":"navigate_next"},{default:c(()=>[p("\u524D\u5F80\u6211\u7684\u8001\u5E2B\u500B\u4EBA\u9801\u9762")]),_:1})]),_:1})]),_:1})):Q("",!0),e.action=="\u6536\u5165\u6982\u89BD"?(g(),C("div",yt,kt)):Q("",!0)])]))]),_:1})}const o=qe();function U(e){return e.replace(/\s*\(.+\)\s*/,"").replace(/T/," ").replace(/\s+-\s*.+$/,"")}function vt(e){const t=new Date(e);return Ye(t).date}const Tt=at({name:"IndexPage",props:["uid","me","users","user","email","photoURL","isLogout","isInApp","teachers","classes","myKey","isAdmin","isTeacher","logs"],components:{NavigationBar:We,QCalendarMonth:Je},setup(){Ke({title:"\u8001\u5E2B\u5F8C\u53F0",noscript:{default:"This is content for browsers with no JS (or disabled JS)"}});const t=s(!1),i=s(""),r=s(["2023-05","2023-06","2023-07","2023-08"]),d=s(""),h=s(""),u=s(""),m=s(""),w=s(""),y=s([]),O=s(""),V=s(""),z=s(""),j=s(""),H=s(""),Z=s(!1),G=s(1/0),K=s(!1),W=s(!1),J=s(!1),Y=s(""),q=s(""),M=s("style"),X=s(1),ee=s(""),te=s(""),se=s(""),ie=s(""),ne=s([{t:"\u6559\u5E2B\u6A94\u6848"},{t:"\u65B0\u589E\u6D3B\u52D5"},{t:"\u6559\u5B78\u7BA1\u7406"},{t:"\u6536\u5165\u6982\u89BD"},{t:"\u96FB\u5B50\u52DE\u52D9"}]),ae=s([{t:"\u6703\u54E1\u8CC7\u6599",path:"/profile"},{t:"\u6703\u54E1\u5C08\u5340",path:"/member_only"},{t:"\u6211\u7684\u6D3B\u52D5",path:"/cal"},{t:"\u8A02\u55AE\u7BA1\u7406",path:"/cart"},{t:"\u6211\u7684\u9EDE\u6578",path:"/my_point"}]),oe=s([]),ue=s(""),re=s(""),le=s(""),ce=s(""),de=s(""),he=s(""),me=s(""),fe=s(""),ge=s(""),we=s(""),pe=s(1),De=s(10),_e=s("NT$0"),Ce=s("NT$0"),Ae=s("NT$0"),Be=s(""),ye=s(""),Fe=s(""),be=s(""),ke=s(""),Ee=s({explore:"all",hoverExplore:"",age:"all",hoverAge:"",place:"all",hoverPlace:"",date:"all",hoverDate:"",price:"all",hoverPrice:"",sorting:"newest",hoverSorting:""}),ve=s(""),Te=s(""),xe=s([]),Pe=s(!1),Le=s("");let T=new Date,Ie=T.getFullYear()+"_"+(T.getMonth()+1)+"_"+T.getDate()+"_"+(""+Math.random()).substring(3,12);const Ue=s(Ie),$e=s(""),Re=s(!1),Ne=s(!1),Qe=[{name:"interval",label:"\u8A08\u916C\u5340\u9593",field:"interval",align:"left"},{name:"predict",label:"\u9810\u89BD\u52DE\u52D9\u5831\u916C\u55AE",field:"predict",align:"left"},{name:"confirm",label:"\u78BA\u8A8D\u52DE\u52D9\u5831\u916C\u55AE",field:"confirm",align:"left"}],Se=[{interval:"\u7DDA\u4E0A\u6D3B\u52D5\uFF5CKoala U. SEL \u60C5\u7DD2\u7121\u5C3E\u718A\u6D3B\u52D5",predict:"NT$12,000",confirm:"NT$12,000"}],Oe=[{name:"name",label:"\u6D3B\u52D5\u540D\u7A31",field:"name",align:"left"},{name:"income",label:"\u6D3B\u52D5\u91D1\u984D",field:"income",align:"left"},{name:"discount",label:"\u6298\u6263\u91D1\u984D",field:"discount",align:"left"},{name:"details",label:"\u8A73\u7D30\u8CC7\u8A0A",field:"details",align:"left"}],Ve=[{name:"\u7DDA\u4E0A\u6D3B\u52D5\uFF5CKoala U. SEL \u60C5\u7DD2\u7121\u5C3E\u718A\u6D3B\u52D5",income:"NT$12,000",discount:"NT$12,000",collection:"NT$12,000",details:"\u7DDA\u4E0A\u6D3B\u52D5\uFF5CKoala U. SEL \u60C5\u7DD2\u7121\u5C3E\u718A\u6D3B\u52D5"}],ze=s($()),je=s("square"),He=s("\u8001\u5E2B"),Ze=s("\u6D3B\u52D5\u4E00\u89BD"),Ge=s("\u6240\u6709\u6D3B\u52D5");return{saved:t,role:He,filter_act:Ge,op:Ze,selectedDate:ze,dateType:je,myOption:Ee,hoverD:ve,showD:Te,columns:Qe,rows:Se,columns1:Oe,rows1:Ve,myMonth:i,months:r,sameAddr:Z,id_card_front:j,id_card_back:H,myAddr:O,myContactAddr:V,id_number:z,myPhone:d,account_name:h,bank_name:u,bank_code:m,bank_account:w,options:ae,inner_options:ne,action:te,myAccounts:y,focusAcc:G,previewP:Re,previewC:Ne,newClasses:oe,newTags:fe,newDate:ue,newTime:re,newEndTime:le,newZh:he,newEn:me,newT_Zh:ge,newT_En:we,newTitle:Be,newLocation:ye,newAddr:Fe,newHref:be,newCid:Ue,newMin:pe,newMax:De,newOldPrice:_e,newNewPrice:Ce,newPrice:Ae,newClassImg:ke,newCer:de,editP:Pe,myPhotoURL:$e,editC:Le,newDes:se,newThought:ie,myImg:ce,newCertifications:xe,myName:Y,new_email:q,step:X,slide:M,myKey2:ee,done1:K,done2:W,done3:J}},mounted(){this.myPhone=this.me.phone||"",this.bank_account=this.me.bank_account||"",this.bank_code=this.me.bank_code||"",this.account_name=this.me.account_name||(this.me.accounts||[{}])[0].account_name||this.me.name||"",this.id_number=this.me.id_number||"",this.id_card_front=this.me.id_card_front||"",this.id_card_back=this.me.id_card_back||"",this.myAddr=this.me.addr||"",this.myContactAddr=this.me.contact_addr||"",this.sameAddr=this.me.same_addr||!1,this.myAccounts=this.me.accounts||[],this.myName=this.me.name||"",this.newDes=this.me.des||"",this.newThought=this.me.thought||"",this.myImg=this.me.img||this.me.photoURL||"",this.myPhotoURL=this.me.photoURL||"",this.newCertifications=this.me.certifications||[]},watch:{newCertifications(e,t){e.length!=t.length&&(this.saved=!1)},newDes(e,t){e!=t&&(this.saved=!1)},newThought(e,t){e!=t&&(this.saved=!1)},myName(e,t){e!=t&&(this.saved=!1)},myAddr(e){this.sameAddr&&(this.myContactAddr=e)},sameAddr(e){e&&(this.myContactAddr=this.myAddr)},me(e){this.myPhone=e.phone||"",this.bank_account=e.bank_account||"",this.bank_code=e.bank_code||"",this.account_name=e.account_name||"",this.id_number=e.id_number||"",this.id_card_front=e.id_card_front||"",this.id_card_back=e.id_card_back||"",this.myAddr=e.addr||"",this.myContactAddr=e.contact_addr||"",this.sameAddr=e.same_addr||!1,this.myAccounts=e.accounts||[],this.myPhone=e.phone||"",this.myName=e.name||"",this.newDes=e.des||"",this.newThought=e.thought||"",this.myImg=e.img||this.me.photoURL||"",this.myPhotoURL=e.photoURL||"",this.newCertifications=e.certifications||[]}},computed:{eventsTeacherMap(){const e={};var t=Object.values(this.classes)||[];return t&&t.length>0&&(this.filter_act=="\u7531\u6211\u958B\u7684\u6D3B\u52D5"&&(t=t.filter(i=>i.tid==this.uid)),this.filter_act=="\u5DF2\u7D50\u675F\u6D3B\u52D5"&&(t=t.filter(i=>{let r=(i.classes||[]).at(-1);if(r){let d=r.d.replace(/\//g,"-").replace(/\s*(\(.+\))/g,"")+"T"+r.t;return new Date(U(d)).getTime()<new Date().getTime()}else return!1})),this.filter_act=="\u5373\u5C07\u958B\u8AB2"&&(t=t.filter(i=>{let r=(i.classes||[]).at(-1);if(r){let d=r.d.replace(/\//g,"-").replace(/\s*(\(.+\))/g,"")+"T"+r.t;return new Date(U(d)).getTime()-new Date().getTime()>-1e3*60*60*24*1&&new Date(U(d)).getTime()-new Date().getTime()<1e3*60*60*24*30}else return!1})),t=t.map(i=>{let r={...i};return r.date=i.startdate.replace(/\//g,"-").replace(/\s*(\(.+\))/g,"").replace(/T.+$/,""),r.dates=(i.classes||[]).map(d=>vt(d.d.replace(/\//g,"-").replace(/\s*(\(.+\))/g,""))),r}),t.sort((i,r)=>new Date(i.date).getTime()-new Date(r.date).getTime()),t.forEach(i=>{i.dates.forEach(r=>{(e[r]=e[r]||[]).push(i)})})),e}},methods:{setRole(e){this.role=e},setFil(e){this.filter_act=e},setOp(e){this.op=e},badgeClasses(e,t,i){return{[`text-white bg-${i||["green","brown","red","blue","purple","orange","yellow"][e]}`]:!0,"rounded-border":!0}},badgeStyles(e){const t={};return e&&(t.bottom=1.2*parseInt(e)+.4+"em"),t},onToday(){this.selectedDate=$(),this.$refs.calendar.moveToToday()},onPrev(){const t=new Date(this.selectedDate).getTime()-1e3*60*60*24*30;this.selectedDate=new Date(t).toLocaleDateString().replace(/\//g,"-"),this.$refs.calendar.prev()},onNext(){const t=new Date(this.selectedDate).getTime()+1e3*60*60*24*30;this.selectedDate=new Date(t).toLocaleDateString().replace(/\//g,"-"),this.$refs.calendar.next()},onMoved(e){console.log("onMoved",e)},onChange(e){console.log("onChange",e)},onClickDate(e){console.log("onClickDate",e)},onClickDay(e){console.log("onClickDay",e)},onClickWorkweek(e){console.log("onClickWorkweek",e)},onClickHeadDay(e){console.log("onClickHeadDay",e)},onClickHeadWorkweek(e){console.log("onClickHeadWorkweek",e)},goto(e){this.$router.push("/class_info/"+e)},gotoT(e){(this.saved||window.confirm("\u78BA\u5B9A\u8981\u524D\u5F80\u55CE\uFF1F\u60A8\u672A\u5132\u5B58\u7684\u66F4\u52D5\u5C07\u6703\u907A\u5931"))&&this.$router.push("/teacher_user_info/"+e)},sel(e){this.action=e.t,window.scrollTo({top:0,behavior:"smooth"})},editAcc(e){this.focusAcc=e,this.account_name=this.myAccounts[e].account_name,this.bank_name=this.myAccounts[e].bank_name,this.bank_code=this.myAccounts[e].bank_code,this.bank_account=this.myAccounts[e].bank_account},cancelAcc(){this.focusAcc=1/0,this.myAccounts=this.myAccounts.filter(e=>e.bank_name!=="\u65B0\u5E33\u6236")},saveAll(){if(!this.account_name){window.alert("\u8ACB\u5148\u8F38\u5165\u60A8\u7684\u59D3\u540D");return}if(!this.myPhone){window.alert("\u8ACB\u5148\u8F38\u5165\u60A8\u7684\u624B\u6A5F\u865F\u78BC");return}if(!this.id_number){window.alert("\u8ACB\u5148\u8F38\u5165\u60A8\u7684\u8EAB\u4EFD\u8B49\u5B57\u865F");return}if(!this.myAddr){window.alert("\u8ACB\u5148\u8F38\u5165\u60A8\u7684\u5730\u5740");return}n(a(o,"users/"+this.uid+"/account_name"),this.account_name),n(a(o,"users/"+this.uid+"/phone"),this.myPhone),n(a(o,"users/"+this.uid+"/addr"),this.myAddr),n(a(o,"users/"+this.uid+"/contact_addr"),this.myContactAddr||this.myAddr),n(a(o,"users/"+this.uid+"/same_addr"),this.sameAddr),n(a(o,"users/"+this.uid+"/id_card_front"),this.id_card_front),n(a(o,"users/"+this.uid+"/id_card_back"),this.id_card_back),n(a(o,"users/"+this.uid+"/id_number"),this.id_number).then(()=>{console.log("user updated"),window.alert("\u8CC7\u6599\u5DF2\u66F4\u65B0")})},saveAcc(e){this.myAccounts[e]={account_name:this.account_name,bank_name:this.bank_name,bank_code:this.bank_code,bank_account:this.bank_account},n(a(o,"users/"+this.uid+"/accounts"),this.myAccounts).then(()=>{console.log("accounts updated!"),this.focusAcc=1/0})},deleteAcc(e){if(window.confirm("\u78BA\u5B9A\u8981\u79FB\u9664\u6B64\u5E33\u6236\u55CE\uFF1F\u9019\u53EF\u80FD\u5C0E\u81F3\u60A8\u7684\u6B0A\u76CA\u53D7\u640D")){var t=[...this.myAccounts];for(let i=0;i<this.myAccounts.length;i++)i!=e&&t.push(this.myAccounts[i]);this.myAccounts=[...t],n(a(o,"users/"+this.uid+"/accounts"),this.myAccounts).then(()=>{console.log("account deleted!"),this.focusAcc=1/0})}},addDateTime(){if(!this.newDate||!this.newTime||!this.newEndTime){window.alert("\u8ACB\u5148\u9078\u53D6\u65E5\u671F/\u6642\u9593/\u7D50\u675F\u6642\u9593");return}else{const e=this.newClasses||[];e.push({d:this.newDate,t:this.newTime+" - "+this.newEndTime}),this.newClasses=e}},removeDateTime(e){const t=this.newClasses||[],i=[];for(let r=0;r<t.length;r++)r!==e&&i.push(t[r]);this.newClasses=i},previewProfile(){this.previewP=!0},previewClass(){this.previewC=!0},startEditC(e){if(e!==this.uid){window.alert("\u9019\u4E0D\u662F\u60A8\u7684\u6D3B\u52D5\uFF0C\u7121\u6CD5\u7DE8\u8F2F");return}const i=this.classes[e];this.newTitle=i.title||"",this.newHref=i.href||"",this.newClassImg=i.img||"",this.newClasses=i.classes||[],this.myImg=i.teacher_img||"",this.newZh=i.zh||"",this.newEn=i.en||"",this.newT_Zh=i.t_zh||"",this.newT_En=i.t_en||"",this.newLocation=i.location||"",this.newAddr=i.addr||"",this.newOldPrice=i.old_price||"0",this.newNewPrice=i.new_price||"0",this.newPrice=i.price||"0",this.newTags=(i.tags||[]).join(","),this.editC=e},updateC(e){n(a(o,"classes/"+e+"/id"),e),n(a(o,"classes/"+e+"/en"),this.newEn),n(a(o,"classes/"+e+"/zh"),this.newZh),n(a(o,"classes/"+e+"/tid"),this.uid),n(a(o,"classes/"+e+"/t_en"),this.newT_En),n(a(o,"classes/"+e+"/t_zh"),this.newT_Zh),n(a(o,"classes/"+e+"/showClass"),this.classes[e].showClass),n(a(o,"classes/"+e+"/old_price"),this.newOldPrice),n(a(o,"classes/"+e+"/new_price"),this.newNewPrice),n(a(o,"classes/"+e+"/price"),this.newPrice),n(a(o,"classes/"+e+"/teacher"),this.me.name||""),n(a(o,"classes/"+e+"/teacher_img"),this.myImg),n(a(o,"classes/"+e+"/tags"),this.newTags.split(",")),n(a(o,"classes/"+e+"/img"),this.newClassImg),n(a(o,"classes/"+e+"/location"),this.newLocation),n(a(o,"classes/"+e+"/addr"),this.newAddr),n(a(o,"classes/"+e+"/href"),this.newHref),n(a(o,"classes/"+e+"/classes"),this.newClasses),n(a(o,"classes/"+e+"/title"),this.newTitle).then(()=>{console.log("class updated!"),window.alert("\u6D3B\u52D5\u8CC7\u8A0A\u5DF2\u66F4\u65B0")})},copyC(){const e=window.prompt("\u8ACB\u8F38\u5165\u8907\u88FD\u5F8C\u7684\u65B0\u6D3B\u52D5id");if(Object.keys(this.classes).indexOf(e)>-1){window.alert("\u4E0D\u80FD\u4F7F\u7528\u5DF2\u5B58\u5728\u7684\u6D3B\u52D5Id");return}else n(a(o,"classes/"+e),{id:e,tid:this.uid,title:this.newTitle||"",teacher:this.me.name||"",teacher_img:this.myImg,classes:this.newClasses||[],showClass:!0,zh:this.newZh||"",en:this.newEn||"",location:this.newLocation||"",addr:this.newAddr,href:this.newHref,tags:this.newTags.split(","),price:this.newPrice,old_price:this.newOldPrice,new_price:this.newNewPrice,t_zh:this.newT_Zh||"",t_en:this.newT_En||"",min:this.newMin||1,max:this.newMax||10}).then(()=>{console.log("class copied!"),window.alert("\u6D3B\u52D5\u5DF2\u8907\u88FD"),this.startEditC(e)})},newC(e){if(Object.keys(this.classes).indexOf(e)>-1){window.alert("\u4E0D\u80FD\u4F7F\u7528\u5DF2\u5B58\u5728\u7684\u6D3B\u52D5Id");return}else{const i=[...this.logs];i.push({time:new Date().getTime(),msg:"\u6559\u5E2B(id: "+this.uid+", \u540D\u7A31: "+this.myName+")\u5DF2\u4E0A\u50B3\u65B0\u6D3B\u52D5(id: "+e+", \u540D\u7A31: "+this.newTitle+")\uFF0C\u7B49\u5F85\u5BE9\u6838\u4E2D",from:this.uid,type:"\u6559\u5E2B",classes:this.newClasses||[]}),n(a(o,"logs"),i).then(()=>{console.log("logs updated!")}),n(a(o,"classes/"+e),{id:e,en:this.newEn,zh:this.newZh,tid:this.uid,t_en:this.newT_En,t_zh:this.newT_Zh,showClass:!1,old_price:this.newOldPrice,new_price:this.newNewPrice,price:this.newPrice,teacher:this.myName,teacher_img:this.myImg,tags:this.newTags.split(","),img:this.newClassImg,location:this.newLocation,addr:this.newAddr,href:this.newHref,title:this.newTitle,classes:this.newClasses||[]}).then(()=>{console.log("class updated!");let d=new Date,h=d.getFullYear()+"_"+(d.getMonth()+1)+"_"+d.getDate()+"_"+(""+Math.random()).substring(3,12);this.newCid=h,window.alert("\u6D3B\u52D5\u8CC7\u8A0A\u5DF2\u4E0A\u50B3\uFF0C\u7B49\u5F85\u7BA1\u7406\u54E1\u5BE9\u6838\u4E2D")});let r=Object.values(this.users);for(let d=0;d<r.length;d++){let h=r[d],u=h.id;if(h.isAdmin){let m=[],w=h.notifications||m;w.push({time:new Date().getTime(),msg:"\u7528\u6236"+this.me.name+"("+this.me.email+") \u63D0\u51FA\u4E86\u65B0\u6D3B\u52D5\u7533\u8ACB\uFF0C\u8ACB\u81F3\u7BA1\u7406\u54E1\u7CFB\u7D71\u67E5\u770B",route:"admin"}),n(a(o,"users/"+u+"/notifications"),w).then(()=>{console.log("notification sent!")}),this.$emit("mailto",h.email,"Colearna_\u65B0\u6D3B\u52D5\u7533\u8ACB","\u7528\u6236"+this.me.name+"("+this.me.email+') \u63D0\u51FA\u4E86\u65B0\u6D3B\u52D5\u7533\u8ACB\uFF0C\u8ACB\u81F3<a href="https://next.colearna.co/admin" target="_blank" rel="noopener norefferer">\u7BA1\u7406\u54E1\u7CFB\u7D71</a>\u67E5\u770B')}}}},uploadImage(e){const t=this.uid;var i=document.createElement("img");const r=e.target.files[0];var d=URL.createObjectURL(r);i.src=d,i.name="photoURL",i.onload=function(){var h=i.width,u=i.height;console.log("IMAGE width",h),console.log("IMAGE height: ",u);var m="";h/u>1.4&&(m="\u5BEC\u9AD8\u6BD4\u904E\u5927\uFF0C\u4E0A\u50B3\u6642\u5C07\u6703\u91CD\u8A2D\u70BA\uFF0C120 x 120\uFF0C\u9019\u5C07\u56B4\u91CD\u626D\u66F2\u5716\u7247\uFF0C\u78BA\u5B9A\u8981\u4E0A\u50B3\u55CE\uFF1F"),h/u<.7&&(m="\u5BEC\u9AD8\u6BD4\u904E\u5C0F\uFF0C\u4E0A\u50B3\u6642\u5C07\u6703\u91CD\u8A2D\u70BA\uFF0C120 x 120\uFF0C\u9019\u5C07\u56B4\u91CD\u626D\u66F2\u5716\u7247\uFF0C\u78BA\u5B9A\u8981\u4E0A\u50B3\u55CE\uFF1F"),(!m||window.confirm(m))&&x({file:r,width:120,height:120,type:"png"}).then(w=>{const v=new FileReader;v.readAsDataURL(w),v.onload=y=>{n(a(o,"users/"+t+"/img"),y.target.result).then(()=>{console.log("image updated!")}),n(a(o,"users_public/"+t+"/img"),y.target.result)}}).catch(w=>{console.log(w)})}},uploadIdCardFront(e){const t=this.uid;var i=document.createElement("img");const r=e.target.files[0];var d=URL.createObjectURL(r);i.src=d,i.name="id_card_front",i.onload=()=>{x({file:r,width:860*2,height:540*2,type:"png"}).then(h=>{const u=new FileReader;u.readAsDataURL(h),u.onload=m=>{n(a(o,"users/"+t+"/id_card_front"),m.target.result).then(()=>{console.log("id_card_front updated!")})}}).catch(h=>{console.log(h)})}},uploadIdCardBack(e){const t=this.uid;var i=document.createElement("img");const r=e.target.files[0];var d=URL.createObjectURL(r);i.src=d,i.name="id_card_back",i.onload=()=>{x({file:r,width:860*2,height:540*2,type:"png"}).then(h=>{const u=new FileReader;u.readAsDataURL(h),u.onload=m=>{n(a(o,"users/"+t+"/id_card_back"),m.target.result).then(()=>{console.log("id_card_back updated!")})}}).catch(h=>{console.log(h)})}},removeCer(e){var t=[...this.newCertifications];t=t.filter(function(i,r){return r!=e}),this.newCertifications=[...t]},addCer(){var e=[...this.newCertifications];e.push(this.newCer),this.newCer="",this.newCertifications=[...e]},go(){this.$nextTick(()=>{this.step++})},loginGoogle(){this.$emit("loginGoogle")},logout(){this.$emit("logout")},cancel(){this.action=""},submit(){if(!this.myName){window.alert("\u8ACB\u5148\u8F38\u5165\u60A8\u7684\u59D3\u540D");return}if(!this.newDes){window.alert("\u8ACB\u5148\u8F38\u5165\u60A8\u7684\u7C21\u4ECB");return}if(!this.newThought){window.alert("\u8ACB\u5148\u8F38\u5165\u60A8\u7684\u6559\u5B78\u7406\u5FF5");return}n(a(o,"users/"+this.uid+"/des"),this.newDes||""),n(a(o,"users/"+this.uid+"/thought"),this.newThought||""),n(a(o,"users/"+this.uid+"/certifications"),this.newCertifications||[]),n(a(o,"users/"+this.uid+"/photoURL"),this.myImg||this.myPhotoURL||this.me.photoURL||"").then(()=>{this.saved=!0,console.log("user data updated!"),window.alert("\u8CC7\u6599\u5DF2\u66F4\u65B0")});const e=[...this.logs];e.push({time:new Date().getTime(),msg:"\u6559\u5E2B(id: "+this.uid+", \u540D\u7A31: "+this.myName+")\u5DF2\u66F4\u65B0\u8CC7\u6599",from:this.uid,type:"\u6559\u5E2B"}),n(a(o,"logs"),e).then(()=>{console.log("logs updated!")}),n(a(o,"users_public/"+this.uid),{id:this.uid,name:this.myName||"",img:this.myImg||this.myPhotoURL,photoURL:this.myPhotoURL||this.photoURL,isParent:!0,isTeacher:this.isTeacher||!1,isAdmin:this.isAdmin||!1,des:this.me.des||"",thought:this.me.thought||"",certifications:this.me.certifications||[],createTime:this.me.createTime||new Date().getTime(),updateTime:new Date().getTime()}).then(()=>{console.log("public user data updated!")})}}});var is=nt(Tt,[["render",Et],["__scopeId","data-v-07366312"]]);export{is as default};
