import{u as l}from"./use-meta.d8f6c85f.js";import{N as g,Q as f,t as u,p as h}from"./NavigationBar.4f882ef7.js";import{Q as _}from"./QPage.25196c1e.js";import{v as c,D as w,A as k,x as d,E as C,G as T,y as p,_ as y,d as B,r}from"./index.1b2c6786.js";import"./QBtn.28a78695.js";import"./QIcon.55f2315c.js";import"./render.052cf9de.js";import"./QSpinner.a70f049c.js";import"./Ripple.72425708.js";import"./use-router-link.a6f89557.js";import"./vm.78afe1d7.js";import"./QItem.ded192b4.js";import"./use-dark.e08b0fca.js";import"./QList.f527e085.js";const m=e=>(C("data-v-c6d15766"),e=e(),T(),e),v={key:0,class:"row flex flex-start-center long-padded"},b=m(()=>p("h2",{class:"text-dark-green"},"\u60A8\u5C1A\u672A\u767B\u5165\uFF0C\u8ACB\u5148\u767B\u5165\u6216\u8A3B\u518A",-1)),x=[b],S={key:1,class:"row flex flex-start-center long-padded"},$=m(()=>p("h2",{class:"text-dark-green"},"\u65BD\u5DE5\u4E2D",-1)),J=[$];function F(e,t,a,o,s,n){return c(),w(_,{padding:""},{default:k(()=>[e.uid?(c(),d("div",S,J)):(c(),d("div",v,x))]),_:1})}function I(e){const t=new Date(e);return h(t).date}function i(e){return e.replace(/\s*\(.+\)\s*/,"").replace(/T/," ").replace(/\s+-\s*.+$/,"")}const M=B({name:"CalenDar",props:["photoURL","myName","myKey","classes","me","uid"],components:{NavigationBar:g,QCalendarMonth:f},setup(){l({title:"\u6211\u7684\u6D3B\u52D5",noscript:{default:"This is content for browsers with no JS (or disabled JS)"}});const t=r(u()),a=r("square"),o=r("\u5BB6\u9577"),s=r("\u6708"),n=r("\u6240\u6709\u6D3B\u52D5"),D=r("\u5B8C\u6210\u6D3B\u52D5");return{selectedDate:t,dateType:a,op:s,filter_act:n,action:D,role:o}},computed:{eventsMap(){const e={};var t=Object.values(this.classes)||[];return console.log(t),t&&t.length>0&&(this.filter_act=="\u7531\u6211\u958B\u7684\u6D3B\u52D5"&&(t=t.filter(a=>a.tid==this.uid)),this.filter_act=="\u6240\u6709\u6D3B\u52D5"&&(t=t.filter(a=>(a.students||[]).map(o=>o.uid).includes(this.uid)),console.log(t)),this.filter_act=="\u5DF2\u7D50\u675F\u6D3B\u52D5"&&(t=t.filter(a=>(a.students||[]).map(o=>o.uid).includes(this.uid)).filter(a=>{let o=(a.classes||[]).at(-1);if(o){let s=o.d.replace(/\//g,"-").replace(/\s*(\(.+\))/g,"")+"T"+o.t;return new Date(i(s)).getTime()<new Date().getTime()}else return!1})),this.filter_act=="\u5373\u5C07\u958B\u8AB2"&&(t=t.filter(a=>(a.students||[]).map(o=>o.uid).includes(this.uid)).filter(a=>{let o=(a.classes||[]).at(-1);if(o){let s=o.d.replace(/\//g,"-").replace(/\s*(\(.+\))/g,"")+"T"+o.t;return new Date(i(s)).getTime()-new Date().getTime()>-1e3*60*60*24*1&&new Date(i(s)).getTime()-new Date().getTime()<1e3*60*60*24*30}else return!1})),t=t.map(a=>{let o={...a};return o.date=a.startdate.replace(/\//g,"-").replace(/\s*(\(.+\))/g,"").replace(/T.+$/,""),console.log(o.date),o.dates=(a.classes||[]).map(s=>I(s.d.replace(/\//g,"-").replace(/\s*(\(.+\))/g,""))),console.log(o.dates),o}),t.sort((a,o)=>(console.log(a),new Date(a.date).getTime()-new Date(o.date).getTime())),t.forEach(a=>{a.dates.forEach(o=>{(e[o]=e[o]||[]).push(a)})})),console.log(e),e}},mounted(){},watch:{action(e){e=="\u6211\u7684\u6536\u85CF"&&l({title:"\u6211\u7684\u6536\u85CF",noscript:{default:"This is content for browsers with no JS (or disabled JS)"}}),e=="\u5B8C\u6210\u6D3B\u52D5"&&l({title:"\u6211\u7684\u6D3B\u52D5",noscript:{default:"This is content for browsers with no JS (or disabled JS)"}})}},methods:{goto(e){this.$router.push("/"+e)},setRole(e){this.role=e},setFil(e){this.filter_act=e},setOp(e){this.op=e},badgeClasses(e,t,a){return{[`text-white bg-${a||["green","brown","red","blue","purple","orange","yellow"][e]}`]:!0,"rounded-border":!0}},badgeStyles(e){const t={};return e&&(t.bottom=1.2*parseInt(e)+.4+"em"),t},onToday(){this.selectedDate=u(),this.$refs.calendar.moveToToday()},onPrev(){const t=new Date(this.selectedDate).getTime()-1e3*60*60*24*30;this.selectedDate=new Date(t).toLocaleDateString().replace(/\//g,"-"),this.$refs.calendar.prev()},onNext(){const t=new Date(this.selectedDate).getTime()+1e3*60*60*24*30;this.selectedDate=new Date(t).toLocaleDateString().replace(/\//g,"-"),this.$refs.calendar.next()},onMoved(e){console.log("onMoved",e)},onChange(e){console.log("onChange",e)},onClickDate(e){console.log("onClickDate",e)},onClickDay(e){console.log("onClickDay",e)},onClickWorkweek(e){console.log("onClickWorkweek",e)},onClickHeadDay(e){console.log("onClickHeadDay",e)},onClickHeadWorkweek(e){console.log("onClickHeadWorkweek",e)}}});var U=y(M,[["render",F],["__scopeId","data-v-c6d15766"]]);export{U as default};
