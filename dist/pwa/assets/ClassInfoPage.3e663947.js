import{u as $}from"./use-meta.4fb1b153.js";import{u as F,s as N,r as v}from"./index.2c9154fd.js";import{q as S,t as y,C as b,z as P,av as x,x as E,_ as M,G as T,r as i}from"./index.6c7c36af.js";import"./index.esm.5c1ec681.js";const k=["src"];function I(e,t,s,a,n,r){const u=S("row");return y(),b(u,{class:"long-padded flex flex-center z-10",style:x({background:"#444","background-blend-mode":"darken","background-size":"cover","background-image":"url("+e.classes[e.$route.params.cid].img+")"})},{default:P(()=>[E("img",{class:"wide cropped",src:e.classes[e.$route.params.cid].img},null,8,k)]),_:1},8,["style"])}const z=F(),O=T({name:"ClassesPage",props:["uid","me","users","user","email","photoURL","isLogout","isInApp","myKey","classes","isAdmin","isTeacher"],setup(){$({title:"\u8AB2\u7A0B\u8A73\u60C5",noscript:{default:"This is content for browsers with no JS (or disabled JS)"}});const t=[],s=i(!1),a=i(5),n=i(""),r=i([1,1,0,0,0]),u=i(0),o=i(0),c=i(!1),h=i(""),l=i(""),d=i("\u9069\u5408\u5E74\u9F61"),m=i("style"),g=i(!1),w=i(t),p=i(""),f=i(""),A=i(""),D=i(0),B=i(""),_=i(["\u89AA\u5B50\u8AB2\u7A0B","\u5927\u4EBA\u8AB2\u7A0B","\u7DDA\u4E0A\u8AB2\u7A0B","\u793E\u4EA4\u60C5\u611F","\u8A9E\u8A00\u5B78\u7FD2","STEAM","\u904B\u52D5"]),C=i(["\u9069\u5408\u5E74\u9F61","\u4E0A\u8AB2\u5730\u5340","\u4E0A\u8AB2\u6642\u9593","\u50F9\u683C"]);return{editR:s,ratingModel:a,myReview:n,step:o,nums:r,myIdx:u,myKey2:l,myKey3:d,slide:m,cs:_,as:C,newName:A,newAge:D,newDate:B,focusDate:g,students:w,newCode:h,useCode:c,newPName:p,newPhone:f}},mounted(){this.me&&this.me.name&&(this.newPName=this.me.name),this.me&&this.me.phone&&(this.newPhone=this.me.phone)},watch:{newDate(){this.focusDate=!1},newName(e){console.log(e);function t(a){const n=new Date,r=new Date(a);let u=n.getFullYear()-r.getFullYear();const o=n.getMonth()-r.getMonth();return(o<0||o===0&&n.getDate()<r.getDate())&&u--,u}const s=this.indexChildOfMe(e);if(s>-1){const a=this.me.childern[s];this.newDate=a.date,console.log(a.date),console.log(t(a.date)),this.newAge=t(a.date),this.$forceUpdate()}}},methods:{indexChildOfMe(e){const t=this.me.childern;var s=-1;return t.forEach((a,n)=>{a.name==e&&(s=n)}),s},amountMean(e){var t=0;for(let s=0;s<e.length;s++)t+=e[s].star;return t/=e.length,String(t).substr(0,3)},nothing(){console.log("btn clicked")},add_to_cart(){if(!this.newPName){window.alert("\u8ACB\u5148\u5BB6\u9577\u59D3\u540D");return}if(!this.newPhone){window.alert("\u8ACB\u5148\u5BB6\u9577\u624B\u6A5F\u865F\u78BC");return}console.log("add_to_cart");var e=this.students.filter(t=>t!=this.newName);e.push({name:this.newName}),this.$emit("add_to_cart",e,String(this.$route.params.cid),this.classes[String(this.$route.params.cid)].classes[this.myIdx],this.countPlans(),this.countTotal(),this.newPName,String(this.newPhone))},isStarted(e){return new Date(e.startdate.replace(/\//g,"-")).getTime()<new Date().getTime()},isPaid(e){return(this.me.paid||[]).filter(t=>t.cid==e).length>0},inCh(e){return!this.me||this.me.childern?!1:this.me.childern.map(function(t){return t.name}).indexOf(e)>-1},getDate_1(e){return!this.me||this.me.childern?null:(this.me.childern.filter(function(t){return t.name==e})||[])[0].date||""},countAge(e){var t=0;if(!this.me||this.me.childern)return null;{const s=new Date((this.me.childern.filter(function(a){return a.name==e})||[])[0].date);return t=new Date().getFullYear()-s.getFullYear(),(new Date().getMonth()<s.getMonth()||new Date().getMonth()==s.getMonth()&&new Date().getDate()<s.getDate())&&t--,t}},addStudent(){if(!this.newName){window.alert("\u8ACB\u5148\u8F38\u5165\u59D3\u540D");return}if(!this.newAge&&!this.inCh(this.newName)){window.alert("\u8ACB\u5148\u8F38\u5165\u5E74\u9F61");return}if(!this.newDate&&!this.inCh(this.newName)){window.alert("\u8ACB\u5148\u8F38\u5165\u751F\u65E5");return}function e(s,a,n){this.name=s,this.age=a,this.date=n}let t=new e(this.newName,this.inCh(this.newName)?this.countAge(this.newName):this.newAge,this.inCh(this.newName)?this.getDate_1(this.newName):this.newDate);this.students.push(t),this.newName="",this.newAge=0,this.newDate=""},countPlans(){var e=[];const t=this.classes[String(this.$route.params.cid)].new_price.replace(/NT\$\s?/g,"").replace(/,/g,"").replace(/,/g,"").replace(/\/.*$/,""),s=t=="Free"||t=="\u514D\u8CBB"?0:parseInt(t),a=this.classes[String(this.$route.params.cid)].plans||[];for(let n=0;n<a.length;n++)this.nums[n]>0&&(e[n]={plan:a[n],num:this.nums[n],price:s});return e},submitR(e,t){var s=this.classes[String(this.$route.params.cid)].reviews||[];s.push({date:new Date().toUTCString().replace(/^.+,s*/,"").replace(/\s\d+:\d+:\d+\s[a-zA-z]+$/,""),from:this.me.name,star:e,text:t}),N(v(z,"classes/"+this.$route.params.cid+"/reviews"),s).then(()=>{console.log("review added"),window.alert("\u8A55\u8AD6\u5DF2\u9001\u51FA")})},countTotal(){var e=0;const t=this.classes[String(this.$route.params.cid)].new_price.replace(/NT\$\s?/g,"").replace(/,/g,"").replace(/,/g,"").replace(/\/.*$/,""),s=t=="Free"||t=="\u514D\u8CBB"?0:parseInt(t),a=this.classes[String(this.$route.params.cid)].plans||[];for(let n=0;n<a.length;n++)this.nums[n]>0&&(e+=s*this.nums[n]);return e},fil(e,t){return t?e.filter(function(s){return JSON.stringify(s).indexOf(t)>-1}):e},go(){this.$nextTick(()=>{this.step++})},loginGoogle(){this.$emit("loginGoogle")},logout(){this.$emit("logout")}}});var K=M(O,[["render",I],["__scopeId","data-v-0cb13c22"]]);export{K as default};
