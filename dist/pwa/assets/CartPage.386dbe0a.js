import{Q as D}from"./QInput.ca83d44b.js";import{Q as P}from"./QCheckbox.6c6a81f1.js";import{Q as le}from"./QForm.4af9a803.js";import{Q as w}from"./QBtn.28a78695.js";import{Q as re}from"./QCard.9070155d.js";import{c as j,a as U}from"./render.052cf9de.js";import{c as N,h as z,g as ne,_ as ie,d as de,r as o,t as ce,v as r,D as _,A as n,L as me,U as pe,y as a,f as d,H as f,C as v,x as h,F as C,S as F,B as b,E as he,G as _e}from"./index.1b2c6786.js";import{Q as q}from"./QImg.771052cc.js";import{Q as I}from"./QItem.ded192b4.js";import{Q as O}from"./QList.f527e085.js";import{Q as S}from"./QTable.a2efb4a5.js";import{Q as fe}from"./QIcon.55f2315c.js";import{Q as ge}from"./QPage.25196c1e.js";import{u as ve}from"./use-meta.d8f6c85f.js";import"./use-key-composition.5ab50ccb.js";import"./QSpinner.a70f049c.js";import"./use-dark.e08b0fca.js";import"./vm.78afe1d7.js";import"./Ripple.72425708.js";import"./use-router-link.a6f89557.js";import"./QSeparator.185553d2.js";import"./QSelect.50bf946e.js";import"./QChip.e81030b4.js";import"./use-prevent-scroll.78aed160.js";import"./selection.1e5afe58.js";import"./format.3e32b8d9.js";import"./use-fullscreen.ea734bfd.js";var x=j({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(e,{slots:t}){const p=ne(),g=N(()=>"q-td"+(e.autoWidth===!0?" q-table--col-auto-width":"")+(e.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(e.props===void 0)return z("td",{class:g.value},U(t.default));const B=p.vnode.key,y=(e.props.colsMap!==void 0?e.props.colsMap[B]:null)||e.props.col;if(y===void 0)return;const{row:A}=e.props;return z("td",{class:g.value+y.__tdClass(A),style:y.__tdStyle(A)},U(t.default))}}}),$=j({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:t}){const p=N(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>z("tr",{class:p.value},U(t.default))}});const Q=window.TPDirect,be=de({name:"ClassesPage",props:["uid","me","users","user","email","photoURL","isLogout","isInApp","myKey","classes","isAdmin","isTeacher"],setup(){ve({title:"\u8CFC\u7269\u8ECA",noscript:{default:"This is content for browsers with no JS (or disabled JS)"}});const p=o([]),g=o([{name:"id",label:"\u7DE8\u8F2F",field:"id",align:"center",required:!0,sortable:!0},{name:"timestemp",label:"\u4EA4\u6613\u6642\u9593",field:"amount",align:"center",required:!0,sortable:!0},{name:"amount",label:"\u7E3D\u91D1\u984D",field:"amount",align:"center",required:!0,sortable:!0}]),B=o([{name:"checked",label:"",field:"checked",align:"center"},{name:"img",label:"\u5716\u7247",field:"img",align:"center"},{name:"title",label:"\u8AB2\u7A0B\u540D\u7A31",field:"title",align:"center",required:!0,sortable:!0},{name:"plans",label:"\u65B9\u6848",align:"left",field:"plans"},{name:"price",label:"\u50F9\u683C",align:"center",field:"price"},{name:"\u524D\u5F80",label:"",field:"id",align:"center"}]),y=o({explore:"all",hoverExplore:"",age:"all",hoverAge:"",place:"all",hoverPlace:"",date:"all",hoverDate:"",price:"all",hoverPrice:"",sorting:"newest",hoverSorting:""}),A=o(""),u=o(""),s=o(""),m=o(""),E=o(""),k=o(""),V=o(""),c=o(!1),l=o(""),T=o(!1),H=o(""),L=o(!1),W=o(""),G=o(""),K=o(0),M=o(null),J=o(null),R=o(""),X=o("\u9069\u5408\u5E74\u9F61"),Y=o("style"),Z=o(["\u89AA\u5B50\u8AB2\u7A0B","\u5927\u4EBA\u8AB2\u7A0B","\u7DDA\u4E0A\u8AB2\u7A0B","\u793E\u4EA4\u60C5\u611F","\u8A9E\u8A00\u5B78\u7FD2","STEAM","\u904B\u52D5"]),ee=o(["3~6\u6B72","6~9\u6B72","9~12\u6B72","13~15\u6B72","15~18\u6B72","18\u6B72\u4EE5\u4E0A","\u6210\u4EBA"]),te=o(["\u7DDA\u4E0A\u8AB2\u7A0B","\u81FA\u5317\u5E02","\u65B0\u5317\u5E02","\u57FA\u9686\u5E02","\u6843\u5712\u5E02","\u5B9C\u862D\u7E23"]),ue=o(["\u5E73\u65E5","\u5047\u65E5","\u4E09\u5929","\u672C\u9031","\u5169\u9031","\u672C\u6708"]),se=o(["\u6700\u9AD8\u50F9\u683C","\u6700\u4F4E\u50F9\u683C","\u9650\u6642\u512A\u60E0","\u7279\u50F9\u6298\u6263","\u9867\u5BA2\u81EA\u8A02\u50F9\u683C"]),ae=o(["\u6700\u65B0\u4E0A\u67B6","\u5373\u5C07\u958B\u59CB"]),oe=o(["\u9069\u5408\u5E74\u9F61","\u4E0A\u8AB2\u5730\u5340","\u4E0A\u8AB2\u6642\u9593","\u50F9\u683C"]);return{columns_paylogs:g,columns:B,selected:p,use_mobile_carrier:T,mobile_carrier:l,addr:s,card_number:A,card_owner:u,card_month:m,card_year:E,cvc:k,tax_id_number:H,use_tax_id_number:c,zip:V,showPop:L,myOption:y,ages:ee,places:te,dates:ue,prices:se,sortings:ae,hoverD:W,showD:G,step:K,myH:M,myH2:J,myKey2:R,myKey3:X,slide:Y,cs:Z,as:oe}},mounted(){Q.setupSDK(127044,"app_pENDXkVEoHhGT8DHLdyTetjnGSYaXCYPz7BDfqO9x9xWPyg4WKk9OQ0kEf5N","sandbox");var e={color:"rgb(0,0,0)",fontSize:"18px",lineHeight:"26px",fontWeight:"300",errorColor:"red",placeholderColor:""};try{Q.card.setup("#cardview-container",e,{isUsedCcv:!0,isMaskCreditCardNumber:window.innerWidth>620,maskCreditCardNumberRange:{beginIndex:6,endIndex:11}}),Q.card.onUpdate(function(t){t.canGetPrime&&console.log("good!")})}catch(t){console.log(t)}},watch:{me(){this.$forceUpdate()}},methods:{countTotal(){const e=this.me&&this.me.cart||[];var t=0;for(let p=0;p<e.length;p++)this.selected.map(g=>g.id).includes(e[p].cid)&&(t+=e[p].total||0);return t},gopay(){this.showPop=!0},my_paylogs(){return this.me.paylogs},pay(){const e=this.me&&[...this.me.cart]||[],t=this.selected,p=this.zip,g=this.addr,B=this.card_owner,y=this.tax_id_number,A=this.mobile_carrier;if(!this.card_owner){window.alert("\u8ACB\u5148\u8F38\u5165\u6301\u5361\u4EBA\u59D3\u540D");return}var u;Q.card.getPrime(s=>{if(s.status!==0){console.error("getPrime error"),window.alert("\u8ACB\u8F38\u5165\u6B63\u78BA\u7684\u5361\u865F\u548C\u65E5\u671F\u8207\u5B89\u5168\u78BC");return}u=s.card.prime,console.log("getPrime success"),this.$axios.post("https://tap-pay-service.inquiry1541.workers.dev/",{prime:u,details:"TapPay Test",amount:this.countTotal(),cardholder:{phone_number:this.me.phone,name:this.card_owner,email:this.me.email,zip_code:this.zip,address:this.addr,national_id:this.tax_id_number||""},remember:!0},{headers:{"content-type":"text/json"}}).then(m=>{if(m.data.msg=="Success"){var E=(this.users[this.uid].paid||[]).concat(e.filter(c=>t.map(l=>l.id).includes(c.cid))).map(c=>{let l={...c};return l.zip=p,l.addr=g,l.card_owner=B,l.tax_id_number=y,l.mobile_carrier=A,l});for(let c=0;c<e.length;c++){var k=e[c].students,V=e[c].cid;if(t.map(l=>l.id).indexOf(V)>-1)for(let l=0;l<(k||[]).length;l++)this.$emit("addStuToClass",k[l].name,V,this.me.childern,this.uid)}this.$emit("updateUser",e.filter(c=>!t.map(l=>l.id).includes(c.cid)),E),this.$emit("addPayLog",this.uid,this.me.name,this.countTotal(),{phone_number:this.me.phone,name:this.card_owner,email:this.me.email,zip_code:this.zip,address:this.addr,national_id:this.tax_id_number||""},e.filter(c=>{var l=c.cid;return t.map(T=>T.id).indexOf(l)>-1}).map(c=>{let l={...c};return l.zip=p,l.addr=g,l.card_owner=B,l.tax_id_number=y,l.mobile_carrier=A,l}),new Date().toLocaleString("zh-TW")),this.showPop=!1,this.step=0,setTimeout(()=>{window.alert("\u4EA4\u6613\u6210\u529F")},2e3)}else window.alert("\u4EA4\u6613\u5931\u6557\uFF0C\u8ACB\u806F\u7D61\u5BA2\u670D\u4EBA\u54E1")}).catch(function(m){console.log(m)})})},goto(e){this.$router.push("/"+e)},go(){this.$nextTick(()=>{this.step++})},loginGoogle(){this.$emit("loginGoogle")},logout(){this.$emit("logout")}}}),i=e=>(he("data-v-38f03a14"),e=e(),_e(),e),ye={class:"pop-container"},Ae=i(()=>a("div",{class:"test"},null,-1)),Be=i(()=>a("h4",{class:"text-dark-green"},"\u4FE1\u7528\u5361\u7D50\u5E33",-1)),Ee=i(()=>a("h6",{class:"text-dark-gray"}," \u7DB2\u7AD9\u6539\u7248\u4E2D\uFF0C2023/06/23\u5373\u53EF\u5B8C\u6574\u9AD4\u9A57\uFF0C\u656C\u8ACB\u671F\u5F85 ",-1)),De=i(()=>a("div",{class:"small-space"},null,-1)),we=i(()=>a("div",{id:"cardview-container"},null,-1)),Ce=i(()=>a("div",{class:"small-space"},null,-1)),Fe=i(()=>a("div",{class:"small-space"},null,-1)),ke=i(()=>a("i",{class:"red star tl"},"*",-1)),Ve=i(()=>a("p",{class:"text-dark-gray atl"},"\u5E33\u55AE\u5730\u5740",-1)),xe=i(()=>a("div",{class:"small-space"},null,-1)),Qe=i(()=>a("div",{class:"small-space"},null,-1)),Te=i(()=>a("i",{class:"red star tl"},"*",-1)),Pe=i(()=>a("p",{class:"text-dark-gray atl"},"\u6301\u5361\u4EBA\u59D3\u540D",-1)),Se=i(()=>a("i",{class:"red star tl"},"*",-1)),$e=i(()=>a("p",{class:"text-dark-gray atl"},"\u90F5\u905E\u5340\u865F",-1)),Ue=i(()=>a("div",{class:"small-space"},null,-1)),ze=i(()=>a("br",null,null,-1)),qe={class:"row flex flex-end-center long-padded"},Ie={class:"text-orange"},Oe={class:"row"},je=i(()=>a("div",{class:"filler"},null,-1)),Ne={class:"col-md-2 col-sm-3 col-xs-4"},He={class:"col-md-2 col-sm-3 col-xs-4"},Le=i(()=>a("h4",{class:"text-dark-green margin"},"\u8CFC\u7269\u8ECA",-1)),We={key:0,class:"q-pa-md"},Ge=i(()=>a("h2",{class:"text-dark-green"},"\u60A8\u5C1A\u672A\u767B\u5165\uFF0C\u8ACB\u5148\u767B\u5165\u6216\u8A3B\u518A",-1)),Ke=[Ge],Me={key:1,class:"q-pa-md",id:"my-cart"},Je={class:"row fluid flex flex-end-center"},Re={class:"text-orange margin"},Xe={key:0},Ye={key:2},Ze=i(()=>a("br",null,null,-1)),et=i(()=>a("br",null,null,-1)),tt={key:3},ut=i(()=>a("h4",{class:"text-dark-green"},"\u5DF2\u8CFC\u8AB2\u7A0B",-1)),st={key:0},at={key:3},ot=i(()=>a("br",null,null,-1)),lt={key:4},rt=i(()=>a("h4",{class:"text-dark-green"},"\u8A02\u55AE\u660E\u7D30",-1)),nt={key:0};function it(e,t,p,g,B,y){const A=ce("router-link");return r(),_(ge,null,{default:n(()=>[me(a("div",ye,[a("div",{class:"pop-back clickable",onClick:t[0]||(t[0]=u=>e.showPop=!1)}),Ae,d(re,{class:"pop-card"},{default:n(()=>[d(le,null,{default:n(()=>[Be,Ee,De,we,Ce,Fe,d(D,{rounded:"",outlined:"",class:"fluid relative",type:"text",label:"",modelValue:e.addr,"onUpdate:modelValue":t[1]||(t[1]=u=>e.addr=u)},{default:n(()=>[ke,Ve]),_:1},8,["modelValue"]),xe,Qe,d(D,{class:"margin relative",rounded:"",outlined:"",style:{width:"260px",display:"inline-block"},type:"text",label:"",modelValue:e.card_owner,"onUpdate:modelValue":t[2]||(t[2]=u=>e.card_owner=u)},{default:n(()=>[Te,Pe]),_:1},8,["modelValue"]),d(D,{class:"margin relative",rounded:"",outlined:"",style:{width:"120px",display:"inline-block"},type:"text",label:"\u90F5\u905E\u5340\u865F",modelValue:e.zip,"onUpdate:modelValue":t[3]||(t[3]=u=>e.zip=u)},{default:n(()=>[Se,$e]),_:1},8,["modelValue"]),Ue,d(P,{"toggle-order":"ft",modelValue:e.use_tax_id_number,"onUpdate:modelValue":t[4]||(t[4]=u=>e.use_tax_id_number=u),label:"\u8EAB\u4EFD\u8B49\u5B57\u865F/\u7D71\u4E00\u7DE8\u865F",class:"text-dark-green bold"},null,8,["modelValue"]),d(D,{class:"margin relative",rounded:"",outlined:"",style:{width:"220px",display:"inline-block"},type:"text",label:"\u8EAB\u4EFD\u8B49\u5B57\u865F/\u7D71\u4E00\u7DE8\u865F",modelValue:e.tax_id_number,"onUpdate:modelValue":t[5]||(t[5]=u=>e.tax_id_number=u)},null,8,["modelValue"]),ze,d(P,{"toggle-order":"ft",modelValue:e.use_mobile_carrier,"onUpdate:modelValue":t[6]||(t[6]=u=>e.use_mobile_carrier=u),label:"\u624B\u6A5F\u8F09\u5177",class:"text-dark-green bold"},null,8,["modelValue"]),d(D,{class:"margin relative",rounded:"",outlined:"",style:{width:"220px",display:"inline-block"},type:"text",label:"\u8F09\u5177\u865F\u78BC",modelValue:e.mobile_carrier,"onUpdate:modelValue":t[7]||(t[7]=u=>e.mobile_carrier=u)},null,8,["modelValue"])]),_:1}),a("div",qe,[a("h2",Ie,"\u7E3D\u91D1\u984D"+f(e.countTotal()),1)]),a("div",Oe,[je,a("div",Ne,[d(w,{rounded:"",unelevated:"",class:"or-border text-orange",onClick:t[8]||(t[8]=u=>{e.step=0,e.showPop=!1}),style:{"min-width":"84px"}},{default:n(()=>[v(" \u53D6\u6D88 ")]),_:1})]),a("div",He,[e.isAdmin?(r(),_(w,{key:1,rounded:"",unelevated:"",class:"or-back text-white",style:{"min-width":"84px"},onClick:t[9]||(t[9]=u=>e.pay())},{default:n(()=>[v(" \u73FE\u5728\u4ED8\u6B3E ")]),_:1})):(r(),_(w,{key:0,disabled:"",rounded:"",unelevated:"",class:"or-back text-white",style:{"min-width":"84px"},title:"\u7DB2\u7AD9\u6539\u7248\u4E2D\uFF0C2023/06/23\u5373\u53EF\u5B8C\u6574\u9AD4\u9A57\uFF0C\u656C\u8ACB\u671F\u5F85"},{default:n(()=>[v(" \u73FE\u5728\u4ED8\u6B3E ")]),_:1}))])])]),_:1})],512),[[pe,e.showPop]]),Le,e.uid?(r(),h("div",Me,[d(S,{flat:"",bordered:"",rows:e.my_cart(Object.values(e.classes||{}),e.me.cart||[],e.me.paid||[]),columns:e.columns,"selected-rows-label":e.getSelectedString,selection:"multiple",selected:e.selected,"onUpdate:selected":t[12]||(t[12]=u=>e.selected=u)},{bottom:n(()=>[a("div",Je,[a("h4",Re,"\u7E3D\u91D1\u984D"+f(e.countTotal()),1),e.selected.length>0?(r(),_(w,{key:0,color:"primary","no-caps":"",label:"\u524D\u5F80\u7D50\u5E33",icon:"shopping_cart_checkout",onClick:t[10]||(t[10]=u=>e.gopay(e.selected))})):(r(),_(w,{key:1,color:"orange",size:"lg",onClick:t[11]||(t[11]=u=>e.goto("classes")),icon:"explore"},{default:n(()=>[v("\u63A2\u7D22\u8AB2\u7A0B")]),_:1}))])]),body:n(u=>[d($,{props:u},{default:n(()=>[d(x,null,{default:n(()=>[d(P,{"model-value":u.selected,"onUpdate:modelValue":(s,m)=>{Object.getOwnPropertyDescriptor(u,"selected").set(s,m)}},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024),(r(!0),h(C,null,F(u.cols,s=>(r(),_(x,{key:s.name,props:u},{default:n(()=>[s.name!="img"&&s.name!="plans"&&s.name!="price"?(r(),h("span",Xe,f(s.value),1)):b("",!0),s.name=="img"?(r(),_(q,{key:1,style:{width:"200px"},src:s.value},null,8,["src"])):b("",!0),s.name=="plans"?(r(),h("span",Ye,[d(O,null,{default:n(()=>[(r(!0),h(C,null,F(s.value,(m,E)=>(r(),_(I,{key:E},{default:n(()=>[v(f(m.plan),1),Ze,v(f(m.price),1),et,v("\xD7 "+f(m.num),1)]),_:2},1024))),128))]),_:2},1024)])):b("",!0),s.name=="price"?(r(),h("span",tt," NT$ "+f(s.value),1)):b("",!0)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","selected-rows-label","selected"]),ut,d(S,{flat:"",bordered:"",rows:e.my_paid(Object.values(e.classes||{}),e.me.cart||[],e.me.paid||[]),columns:e.columns},{body:n(u=>[d($,{props:u},{default:n(()=>[(r(!0),h(C,null,F(u.cols,s=>(r(),_(x,{key:s.name,props:u},{default:n(()=>[s.name!="img"&&s.name!="plans"&&s.name!="price"&&s.name!="id"?(r(),h("span",st,f(s.value),1)):b("",!0),s.name=="id"?(r(),_(A,{key:1,to:"/classInfo"+s.value},{default:n(()=>[v(" \u524D\u5F80\u8AB2\u7A0B "),d(fe,{name:"chevron_right"})]),_:2},1032,["to"])):b("",!0),s.name=="img"?(r(),_(q,{key:2,style:{width:"200px"},src:s.value},null,8,["src"])):b("",!0),s.name=="plans"?(r(),h("span",at,[d(O,null,{default:n(()=>[(r(!0),h(C,null,F(s.value,(m,E)=>(r(),_(I,{key:E},{default:n(()=>[v(f(m.plan),1),ot,v(f(m.price)+" \xD7 "+f(m.num),1)]),_:2},1024))),128))]),_:2},1024)])):b("",!0),s.name=="price"?(r(),h("span",lt," NT$ "+f(s.value),1)):b("",!0)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),rt,d(S,{flat:"",bordered:"",rows:e.my_paylogs(Object.values(e.classes||{}),e.me.cart||[],e.me.paid||[]),columns:e.columns_paylogs,"row-key":"id"},{body:n(u=>[d($,{props:u},{default:n(()=>[(r(!0),h(C,null,F(u.cols,s=>(r(),_(x,{key:s.name,props:u},{default:n(()=>[s.name=="amount"?(r(),h("span",nt," NT$ "+f(s.value),1)):b("",!0)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns"])])):(r(),h("div",We,Ke))]),_:1})}var zt=ie(be,[["render",it],["__scopeId","data-v-38f03a14"]]);export{zt as default};
